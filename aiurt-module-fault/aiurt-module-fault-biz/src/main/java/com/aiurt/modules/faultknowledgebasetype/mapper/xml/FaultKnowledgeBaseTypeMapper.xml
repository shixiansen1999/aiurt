<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.aiurt.modules.faultknowledgebasetype.mapper.FaultKnowledgeBaseTypeMapper">

<select id="getAllSubSystem" resultType="java.lang.String">
    select
    cs.system_code
    from cs_user_subsystem cus left join cs_subsystem cs on cs.system_code = cus.system_code
    where cus.user_id =#{userId}
    </select>

<select id="getAllMajor" resultType="com.aiurt.modules.faultknowledgebasetype.dto.MajorDTO">
    select id,major_code,major_name
    from cs_major
    where del_flag = 0
    and major_code in
    <foreach collection="majorCodes" index="item" open="(" separator="," close=")">
        #{item}
    </foreach>
    order by create_time
    </select>

<select id="getMajorByUser" resultType="java.lang.String">
    select major_id
    from cs_user_major cum left join cs_major cm on cm.major_code = cum.major_id
    where cum.user_id =#{userId}
    </select>

<select id="getSubSystemByUser" resultType="com.aiurt.modules.faultknowledgebasetype.dto.SubSystemDTO">
    select
    cs.id,
    cs.system_name,
    cs.system_code,
    cs.major_code
    from cs_user_subsystem cus left join cs_subsystem cs on cs.system_id = cus.system_code
    where cus.user_id =#{userId}
    <if test="majorCode != null and majorCode != ''">
        and cs.major_code =#{majorCode}
    </if>
    order by cs.create_time
    </select>
</mapper>