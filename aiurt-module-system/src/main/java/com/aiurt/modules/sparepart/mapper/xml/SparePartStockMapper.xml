<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.aiurt.modules.sparepart.mapper.SparePartStockMapper">

    <select id="queryPageList"
            resultType="com.aiurt.modules.sparepart.entity.dto.SparePartStockDTO">
        select sps.id,sps.material_code materialCode,mb.name materialName,mb.type materialType,
            mb.specifications,mb.country_origin countryOrigin,
            mb.manufacturer,mb.brand,mb.unit,sps.num,w.warehouse_name warehouseName
        from spare_part_stock sps
        left join spare_part_stock_info w on w.warehouse_code=sps.warehouse_code
        left join material_base mb on mb.code=sps.material_code
        where 1=1 and sps.del_flag!=1
        <if test="sparePartStock.materialCode!=null and sparePartStock.materialCode!=''">
            and sps.material_code = #{sparePartStock.materialCode}
        </if>
        <if test="sparePartStock.materialName!=null and sparePartStock.materialName!=''">
            and mb.name like concat('%', #{sparePartStock.materialName}, '%')
        </if>
        <if test="sparePartStock.materialType!=null and sparePartStock.materialType!=''">
            and mb.type = #{sparePartStock.materialType}
        </if>
        <if test="sparePartStock.warehouseCode!=null and sparePartStock.warehouseCode!=''">
            and sps.warehouse_code = #{sparePartStock.warehouseCode}
        </if>
    </select>
    <select id="queryMaterialByWarehouse"
            resultType="com.aiurt.modules.sparepart.entity.vo.SpareMaterialVO">
        select sps.material_code materialCode,mb.name materialName,sps.num
        from spare_part_stock sps
        left join material_base mb on mb.code=sps.material_code
        where 1=1 and sps.del_flag!=1
        <if test="warehouseCode!=null and warehouseCode!=''">
            and sps.warehouse_code = #{warehouseCode}
        </if>
    </select>
</mapper>
