<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.aiurt.boot.modules.fault.mapper.OutsourcingPersonnelMapper">
    <select id="queryOutsourcingPersonnel" resultType="com.aiurt.boot.common.result.OutsourcingPersonnelResult">
        SELECT op.*,
        cst.system_name AS systemName
        FROM outsourcing_personnel op
        LEFT JOIN cs_subsystem cst ON op.system_code = cst.system_code
        WHERE
            op.del_flag = '0'
        <if test="personnel.name!= null and personnel.name!= ''">
            AND op.name LIKE concat('%'
            , #{personnel.name}
            , '%')
        </if>
        <if test="personnel.company!= null and personnel.company!= ''">
            AND op.company = #{personnel.company}
        </if>
        <if test="personnel.position!= null and personnel.position!= ''">
            AND op.position LIKE concat('%'
            , #{personnel.position}
            , '%')
        </if>
        <if test="personnel.systemCode!= null and personnel.systemCode!= ''">
            AND op.system_code = #{personnel.systemCode}
        </if>
        <if test="personnel.connectionWay!= null and personnel.connectionWay!= ''">
            AND op.connection_way LIKE concat('%'
            , #{personnel.connectionWay}
            , '%')
        </if>
        ORDER BY op.create_time DESC
    </select>

    <select id="exportXls" resultType="com.aiurt.boot.common.result.OutsourcingPersonnelResult">
        SELECT op.*,
        cst.system_name AS systemName
        FROM outsourcing_personnel op
        LEFT JOIN cs_subsystem cst ON op.system_code = cst.system_code
        WHERE
        op.del_flag = '0'
        <if test="personnel.name!= null and personnel.name!= ''">
            AND op.name LIKE concat('%'
            , #{personnel.name}
            , '%')
        </if>
        <if test="personnel.company!= null and personnel.company!= ''">
            AND op.company = #{personnel.company}
        </if>
        <if test="personnel.position!= null and personnel.position!= ''">
            AND op.position LIKE concat('%'
            , #{personnel.position}
            , '%')
        </if>
        <if test="personnel.systemCode!= null and personnel.systemCode!= ''">
            AND op.system_code = #{personnel.systemCode}
        </if>
        <if test="personnel.connectionWay!= null and personnel.connectionWay!= ''">
            AND op.connection_way LIKE concat('%'
            , #{personnel.connectionWay}
            , '%')
        </if>
        ORDER BY op.create_time DESC
    </select>

</mapper>
