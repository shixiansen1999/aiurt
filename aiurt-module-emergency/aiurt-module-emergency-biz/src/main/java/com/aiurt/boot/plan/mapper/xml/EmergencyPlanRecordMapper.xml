<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.aiurt.boot.plan.mapper.EmergencyPlanRecordMapper">
    <select id="queryPageList" resultType="com.aiurt.boot.plan.dto.EmergencyPlanRecordDTO">
        select epr.*
        from emergency_plan_record epr
        left join emergency_plan ep on ep.id = epr.emergency_plan_id
        where epr.del_flag = 0
        <if test="condition.eventClass != null and condition.eventClass != ''">
            and epr.event_class = #{condition.eventClass}
        </if>
        <if test="condition.emergencyPlanId != null and condition.emergencyPlanId != ''">
            and epr.emergency_plan_id = #{condition.emergencyPlanId}
        </if>
        <if test="condition.startDate != null and condition.endDate != null">
            and date_format(epr.record_time ,'%Y-%m-%d') &gt;=  date_format(#{condition.startDate},'%Y-%m-%d')
            and date_format(epr.record_time ,'%Y-%m-%d') &lt;= date_format(#{condition.endDate},'%Y-%m-%d')
        </if>
        <if test="orgCodes != null and orgCodes.size() > 0">
            and
            epr.org_code in
            <foreach collection="orgCodes" item="item" separator="," open="(" close=")">
                #{item}
            </foreach>
        </if>
    </select>
</mapper>
