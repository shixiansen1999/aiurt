<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.aiurt.boot.plan.mapper.RepairPoolStationRelMapper">
    <insert id="insertBatch">
        INSERT INTO `repair_pool_station_rel` ( `id`, `repair_pool_code`, `station_code`, `line_code`, `position_code` )
        VALUES
        <foreach collection ="repairPoolStationRel" item="stationrel" separator =",">
            (  #{stationrel.id},  #{stationrel.repairPoolCode}, #{stationrel.stationCode},
            #{stationrel.lineCode},  #{stationrel.positionCode}  )
        </foreach >
    </insert>

    <select id="selectStationList" resultType="com.aiurt.boot.plan.dto.StationDTO">
        select station_code,position_code,line_code from repair_pool_station_rel where del_flag = 0 and  repair_pool_code = #{planCode}
    </select>

    <select id="selectStationToMapByPlanCode" resultType="com.aiurt.boot.index.dto.MapDTO">
        select
        rpsr.repair_pool_code as `value`,
        GROUP_CONCAT(rpsr.station_code) as `text`
        from
        repair_pool_station_rel rpsr
        <where>
            rpsr.del_flag = 0
            <if test="planCodes!=null and planCodes.size()>0">
                and rpsr.repair_pool_code in
                <foreach collection="planCodes" item="item" open="(" close=")" separator=",">
                    #{item}
                </foreach>
            </if>
        </where>
        group by rpsr.repair_pool_code
    </select>
</mapper>
