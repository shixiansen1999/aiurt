<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.aiurt.boot.task.mapper.RepairTaskStationRelMapper">
    <insert id="batchInsert" parameterType="java.util.List">
        INSERT INTO repair_task_station_rel (id,line_code, station_code, position_code, repair_task_code)
        VALUES
        <foreach collection="list" item="item" separator=",">
            (#{item.id}, #{item.lineCode}, #{item.stationCode}, #{item.positionCode}, #{item.repairTaskCode})
        </foreach>
    </insert>
    <select id="selectStationToMapByPlanCode" resultType="com.aiurt.boot.index.dto.MapDTO">
        select
        rtsr.repair_task_code as `value`,
        GROUP_CONCAT(rtsr.station_code) as `text`
        from
        repair_task_station_rel rtsr
        <where>
            rtsr.del_flag = 0
            <if test="planCodes!=null and planCodes.size()>0">
                and rtsr.repair_task_code in
                <foreach collection="planCodes" item="item" open="(" close=")" separator=",">
                    #{item}
                </foreach>
            </if>
        </where>
        group by rtsr.repair_task_code
    </select>
</mapper>
